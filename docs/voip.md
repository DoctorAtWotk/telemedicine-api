# Интернет-звонок

## Запрос на консультацию

`POST /api/v1/voiprequest/start` вернёт информацию о запущенной консультации.

### Запрос:

Имя | Тип | Описание
--- | --- | ---
doctorId | integer | уникальный идентификатор врача
patientFullName | string | фио пациента
videoSupport | boolean | поддержка видео во время консультации
beginAtUtc | datetime | (optional) время начала консультации. Если параметр не указан, то консультация начнется сразу.
duration | integer | (optional) максимальная длительность консультации в минутах.
attachment | file | (optional) информация с информацией о пациенте (может послужить предметом обсуждения во время консультации). Содержимое multipart/form-data. Максимальный размер вложения 10 МБ.
externalNotificationUrl | string | (optional) web-hook URL. По этому адресу будет отправлен GET-запрос без каких-либо дополнительных параметров, если был изменен статус консультации. Например, было добавлено заключение, и статус консультации был изменен на "Завершено".

### Ответ:

```json
{
  //.. объект интернет-звонок
}
```

## Получение информации о консультации

`GET /api/v1/voiprequest/get/{id}` вернёт информацию о консультации.

### Запрос

Имя | Тип | Описание
--- | --- | ---
id | string | уникальный идентификатор консультации вида интернет-звонок

### Ответ

```json
{
  //.. объект интернет-звонок
}
```

## Поиск по консультациям

`GET /api/v1/voiprequest/get-all` вернёт список консультаций.

### Запрос

Имя | Тип | Описание
--- | --- | ---
ids | array | уникальные идентификаторы консультации вида интернет-звонок
statuses | array | статусы консультации
order | string | сортировать по полю (Created, Status)
asc | boolean | сортировать по возрастанию
limit | integer | кол-во (записей в ответе)
offset | integer | смещение (сколько записей пропустить)
videoSupport | boolean | явное указание типа интернет-консультаций

### Ответ

```json
{
  "items": [
    {
      //.. объект интернет-звонок
    }
  ],
  "count": 10,
  "totalCount": 15
}
```

## Отмена запроса / Прерывание консультации

`POST /api/v1/voiprequest/terminate` вернёт информацию об отменяемой консультации.

### Запрос:

Имя | Тип | Описание
--- | --- | ---
requestId | integer | уникальный идентификаторы консультации вида интернет-звонок
reason | string | причина

### Ответ:

```json
{
  "success": false,
  "messages": [
    "The consultation is about to start."
  ]
}
```

## Получение оставшегося времени до окончания ожидания врача

`GET /api/v1/voiprequest/timeout` вернёт количество миллисекунд до окончания ожидания ответа врача.

### Запрос

Имя | Тип | Описание
--- | --- | ---
requestId | string | уникальный идентификатор консультации вида интернет-звонок

### Ответ

```
1501245651542
```
